/* =========================================================
   Stag Lore — Desk + Book (SNAP SYSTEM)
   - Background is an <img> with object-fit: cover
   - Book anchor is positioned/sized by JS using Photopea map
   - Hot book overlays the baked book perfectly
   ========================================================= */

:root{
  --text: rgba(231,226,219,.92);

  /* Book 3D tuning (visual only; position handled by JS) */
  --tiltX: 12deg;
  --tiltZ: -7deg;

  /* Glow */
  --glowA: rgba(255, 168, 64, .22);
  --glowB: rgba(255, 120, 40, .12);

  /* Vignette strength */
  --v1: .08;
  --v2: .58;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  background:#050608;
  color:var(--text);
  overflow:hidden;
  font-family: ui-serif, Georgia, "Times New Roman", serif;
}

/* =========================
   BACKGROUND (fixed image)
   ========================= */
.bg{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit: cover;
  object-position: center;
  z-index:-5;
  transform: translateZ(0);
  user-select:none;
  pointer-events:none;
}

/* Atmos overlay (dust / vignette) */
.atmos{
  position:fixed;
  inset:0;
  z-index:-4;
  pointer-events:none;
  background:
    radial-gradient(120% 90% at 50% 10%, rgba(255,255,255,var(--v1)), transparent 60%),
    radial-gradient(120% 120% at 50% 45%, transparent 55%, rgba(0,0,0,var(--v2)) 100%),
    linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.26));
}

/* =========================
   STAGE
   ========================= */
.stage{
  position:relative;
  height:100%;
  width:100%;
}

.desk-scene{
  position:relative;
  height:100%;
  width:100%;
}

/* =========================
   BOOK ANCHOR (snapped by JS)
   ========================= */
.book-anchor{
  position:absolute; /* JS sets left/top/width/height */
  padding:0;
  border:0;
  background:transparent;
  cursor:pointer;
  z-index:10;

  user-select:none;
  -webkit-tap-highlight-color: transparent;
}

/* Book image (fills anchor; visual transform only) */
.book{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  display:block;
  pointer-events:none;

  transform:
    perspective(900px)
    rotateX(var(--tiltX))
    rotateZ(var(--tiltZ));
  transform-origin: 50% 60%;

  filter: drop-shadow(0 18px 26px rgba(0,0,0,.50));
}

/* Ambient shadow (broad, soft) */
.shadow-ambient{
  position:absolute;
  left:50%;
  top:58%;
  width: 82%;
  height: 28%;
  transform: translate(-50%, -50%) rotateZ(var(--tiltZ));
  border-radius: 50%;
  background: radial-gradient(circle at 50% 50%,
    rgba(0,0,0,.32),
    rgba(0,0,0,0) 70%
  );
  filter: blur(10px);
  opacity: .65;
  pointer-events:none;
}

/* Contact shadow (tight; kills “hovering”) */
.shadow-contact{
  position:absolute;
  left:50%;
  top:62%;
  width: 74%;
  height: 18%;
  transform: translate(-50%, -50%) rotateZ(var(--tiltZ));
  border-radius: 50%;
  background: radial-gradient(circle at 50% 55%,
    rgba(0,0,0,.45),
    rgba(0,0,0,0) 65%
  );
  filter: blur(6px);
  opacity: .92;
  pointer-events:none;
}

/* Embers canvas sits above book */
.embers{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  z-index:12;
  pointer-events:none;
  opacity:0;
  transition: opacity .22s ease;
}

/* Optional hint */
.book-hint{
  position:absolute;
  left:50%;
  top:92%;
  transform: translate(-50%, -50%);
  font-size: 12px;
  letter-spacing: .28em;
  opacity:.42;
  text-transform:uppercase;
  z-index:12;
  pointer-events:none;
}

/* Hover / focus: ritual wake */
.book-anchor:hover .embers,
.book-anchor:focus-visible .embers{
  opacity:1;
}

.book-anchor:hover .book,
.book-anchor:focus-visible .book{
  filter:
    drop-shadow(0 18px 26px rgba(0,0,0,.52))
    drop-shadow(0 0 22px var(--glowA))
    drop-shadow(0 0 46px var(--glowB));
}

.book-anchor:focus-visible{
  outline: 2px solid rgba(255, 190, 120, .22);
  outline-offset: 8px;
  border-radius: 18px;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .embers{ transition:none; }
  .book-anchor:hover .book{ filter: drop-shadow(0 18px 26px rgba(0,0,0,.52)); }
}